!function(e){var t={};function l(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.m=e,l.c=t,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)l.d(a,s,function(t){return e[t]}.bind(null,s));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l(l.s=0)}([function(e,t,l){e.exports=l(1)},function(e,t){const l=window.jQuery,a=l.fn.val;function s(e,t){return e.replace(new RegExp("#{(.+?)}","g"),(e,l)=>t[l]?t[l]:new RegExp("(.+?):selected?(.+?)","g").test(l)?t[l.split(":")[0]]===l.split("?").pop()?' selected="selected"':"":new RegExp("(.+?):checked?(.+?)","g").test(l)&&t[l.split(":")[0]]===l.split("?").pop()?' checked="checked"':"")}l.fn.val=function(){const e=a.apply(this,arguments);return arguments.length>0&&l(this).trigger("lazyblocks-change"),e},jQuery(()=>{wp.api.loadPromise.done(function(){wp.api.models.Lazyblocks_templates&&function(){if(!wp.api||!wp.blocks||!l("body.post-type-lazyblocks_templates").length)return;wp.blockLibrary&&wp.blockLibrary.registerCoreBlocks&&wp.blockLibrary.registerCoreBlocks();const e=l(".lzb-templates-buttons"),t=l(".lzb-templates-list"),a=wp.blocks.getBlockTypes(),o=wp.blocks.getCategories(),n={},i={},c={};let p="";i.lazyblocks=[],o.forEach(e=>{c[e.slug]=e.title,i[e.slug]=[]}),a.forEach(e=>{if((!e.parent||!e.parent.length)&&("lazyblock-core/free"===e.name||!e.supports||void 0===e.supports.inserter||e.supports.inserter)){i[e.category]||(i[e.category]=[]);let t=e.icon.src?e.icon.src:e.icon;"function"==typeof t?t=wp.element.renderToString(t()):"object"==typeof t?t=wp.element.renderToString(t):"string"==typeof t&&(t=wp.element.createElement(wp.components.Dashicon,{icon:t}),t=wp.element.renderToString(t)),n[e.name]={name:e.name,title:e.title,icon:t,useOnce:!e.supports||void 0===e.supports.multiple||e.supports.multiple},i[e.category][e.name]=n[e.name]}}),Object.keys(i).forEach(e=>{p+=`<optgroup label="${c[e]||e}">`,Object.keys(i[e]).forEach(t=>{const l=i[e][t];p+=`<option value="${l.name}">${l.title}</option>`}),p+="</optgroup>"});const r='\n        <div class="lzb-templates-single" data-template-id="#{ID}" data-template-post-type="#{post_type}" data-template-post-label="#{post_label}">\n            <div class="lzb-metabox">\n                <div class="lzb-metabox-label">\n                    <label>#{post_label}</label>\n                </div>\n            </div>\n            <div class="lzb-metabox">\n                <div class="lzb-metabox-label">\n                    <label>Template Lock</label>\n                </div>\n                <div>\n                    <select class="lzb-select" name="template_lock">\n                        <option value="">None</option>\n                        <option value="all" #{template_lock:selected?all}>Prevent all operations</option>\n                        <option value="insert" #{template_lock:selected?insert}>Prevent inserting new blocks, but allows moving existing ones</option>\n                    </select>\n                </div>\n            </div>\n            <div class="lzb-metabox">\n                <div class="lzb-metabox-label">\n                    <label>Blocks</label>\n                </div>\n                <div>\n                    <ul class="lzb-templates-single-blocks">#{blocks}</ul>\n                    <select class="lzb-select lzb-templates-single-add-blocks" placeholder="+ Add block">\n                        #{blocks_list}\n                    </select>\n                </div>\n            </div>\n            <ul class="lzb-templates-single-actions">\n                <a href="#" class="lzb-templates-single-actions-remove">Remove</a>\n                <button class="button button-primary lzb-templates-single-actions-save">Save Template</button>\n            </ul>\n        </div>\n    ',d='\n        <div class="lzb-templates-single-blocks-block #{class}" data-block-name="#{name}">\n            <span class="lzb-templates-single-blocks-block-icon">#{icon}</span>\n            <span>#{title} <small>[#{name}]</small></span>\n            <button class="lzb-templates-single-blocks-block-remove"><span class="dashicons dashicons-no-alt"></span></button>\n        </div>\n    ';function b(l,a="append"){t[a](s(r,l)),e.find('[data-post-type="'+l.post_type+'"]').attr("disabled","disabled")}function m(){void 0!==l.fn.selectize&&l(".lzb-select:not(.lzb-select-ready)").each(function(){const e=l(this).addClass("lzb-select-ready"),t=e.attr("placeholder"),a=e.hasClass("lzb-templates-single-add-blocks");e.selectize({allowEmptyOption:!t,placeholder:t,searchField:["text","optgroup"],onChange(){a&&setTimeout(()=>{e[0].selectize.clear()},20)},onInitialize(){t&&e[0].selectize.clear()},render:{option:function(e,t){let l="";return n[e.value]&&(l=n[e.value].icon),`<div><span class="selectize-svg-icon">${l}</span>${t(e.text)}</div>`}}})})}new wp.api.collections.Lazyblocks_templates({data:{per_page:999}}).fetch().done(function(e){t.html(""),e.forEach(e=>{let t;try{t=JSON.parse(decodeURI(e.meta.lzb_template_data))}catch(e){t={}}let l="";t.blocks.forEach(e=>{let t=e;t.title="Undefined Block",n[e.name]?t=n[e.name]:(t.icon='<svg aria-hidden="true" role="img" focusable="false" class="dashicon dashicons-warning" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path d="M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"></path></svg>',t.class="lzb-templates-single-blocks-undefined"),l+=s(d,t)}),b({ID:e.id,post_type:t.post_type||"post",post_label:t.post_label||t.post_type||"post",blocks:l,template_lock:t.template_lock||"",blocks_list:p}),m()})}),e.on("click","button",function(e){e.preventDefault();const t=l(this);t.attr("disabled","disabled"),new wp.api.models.Lazyblocks_templates({title:l(this).attr("data-post-label"),status:"publish",meta:{lzb_template_data:encodeURI(JSON.stringify({post_type:t.attr("data-post-type"),post_label:t.attr("data-post-label"),template_lock:"",blocks:[]}))}}).save().done(function(e){e&&e.id?(b({ID:e.id,post_type:t.attr("data-post-type"),post_label:t.attr("data-post-label"),blocks:"",template_lock:"",blocks_list:p},"prepend"),m()):t.removeAttr("disabled")})}),t.on("click",".lzb-templates-single-actions-save",function(e){e.preventDefault();const t=l(this),a=l(this).closest("[data-template-id]"),s=[];a.find(".lzb-templates-single-blocks .lzb-templates-single-blocks-block").each(function(){s.push({name:l(this).attr("data-block-name")})});const o=new wp.api.models.Lazyblocks_templates({id:a.attr("data-template-id"),meta:{lzb_template_data:encodeURI(JSON.stringify({post_type:a.attr("data-template-post-type"),post_label:a.attr("data-template-post-label"),template_lock:a.find('[name="template_lock"]').val()||"",blocks:s}))}});t.attr("disabled","disabled"),o.save().done(function(){setTimeout(()=>{t.removeAttr("disabled")},500)})}),t.on("click",".lzb-templates-single-actions-remove",function(t){t.preventDefault();const a=l(this).closest("[data-template-id]"),s=new wp.api.models.Lazyblocks_templates({id:a.attr("data-template-id")});a.hide(),s.destroy({force:!0}).done(function(t){t&&t.deleted?(e.find('[data-post-type="'+a.attr("data-template-post-type")+'"]').removeAttr("disabled"),a.remove()):(console.log(t),a.show())})}),t.on("change",".lzb-templates-single-add-blocks",function(e){e.preventDefault();const t=l(this),a=t.val(),o=t.closest("[data-template-id]");n[a]&&o.find(".lzb-templates-single-blocks").append(s(d,n[a])),t.val("")}),t.on("click",".lzb-templates-single-blocks-block-remove",function(e){e.preventDefault(),l(this).closest(".lzb-templates-single-blocks-block").remove()})}()})})}]);